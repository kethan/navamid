!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).navamid=t()}(this,(function(){"use strict";function e(e,t){history[e]||(history[e]=e,t=history[e+="State"],history[e]=function(n){var r=new Event(e.toLowerCase());return r.uri=n,t.apply(this,arguments),dispatchEvent(r)})}return function(t,n,r=(()=>{})){var i,s,u=[],o={url:{},params:{}},a={},f={redirect:(e,t)=>a.route(e,t)},l=[],c=r,p=a.format=function(e){return e?(e="/"+e.replace(/^\/|\/$/g,""),i.test(e)&&e.replace(i,"/")):e};return t="/"+(t||"").replace(/^\/|\/$/g,""),i="/"==t?/^\/+/:new RegExp("^\\"+t+"(?=\\/|$)\\/?","i"),a.route=function(e,n){"/"!=e[0]||i.test(e)||(e=t+e),history[(e===s||n?"replace":"push")+"State"](e,null,e)},a.use=function(...e){return l=[...l,...e],a},a.on=function(e,...t){return(e=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,i,s,u=[],o="",a=e.split("/");for(a[0]||a.shift();i=a.shift();)"*"===(n=i[0])?(u.push("wild"),o+="/(.*)"):":"===n?(r=i.indexOf("?",1),s=i.indexOf(".",1),u.push(i.substring(1,~r?r:~s?s:i.length)),o+=~r&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~r?"?":"")+"\\"+i.substring(s))):o+="/"+i;return{keys:u,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}(e)).fns=[...l,...t],u.push(e),a},a.run=function(e){var t,r,i=0,l={};if(e=p(e||location.pathname)){for(e=e.match(/[^\?#]*/)[0],s=e;i<u.length;i++)if(t=(r=u[i]).pattern.exec(e)){for(i=0;i<r.keys.length;)l[r.keys[i]]=t[++i]||null;let n=[...r.fns],s=(e,t)=>{try{let r=n.shift();r?r(e,t,(n=>n?c(n,e,t):s(e,t))):c(null,e,t)}catch(r){c(r,e,t)}};return o.params=l,o.url=e,s(o,f),a}n&&n(e,o,f)}return a},a.listen=function(t,n){function r(e){a.run()}function s(e){var t=e.target.closest("a"),n=t&&t.getAttribute("href");e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button||e.defaultPrevented||n&&!t.target&&t.host===location.host&&"#"!=n[0]&&("/"!=n[0]||i.test(n))&&(e.preventDefault(),a.route(n))}return e("push"),e("replace"),addEventListener("popstate",r),addEventListener("replacestate",r),addEventListener("pushstate",r),addEventListener("click",s),a.unlisten=function(){removeEventListener("popstate",r),removeEventListener("replacestate",r),removeEventListener("pushstate",r),removeEventListener("click",s)},n&&n(),a.run(t)},a}}));
