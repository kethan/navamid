(function(v,m){typeof exports=="object"&&typeof module!="undefined"?module.exports=m():typeof define=="function"&&define.amd?define(m):(v=typeof globalThis!="undefined"?globalThis:v||self,v.navamid=m())})(this,function(){"use strict";function v(n,c){if(n instanceof RegExp)return{keys:!1,pattern:n};var p,s,o,a,t=[],f="",h=n.split("/");for(h[0]||h.shift();o=h.shift();)p=o[0],p==="*"?(t.push("wild"),f+="/(.*)"):p===":"?(s=o.indexOf("?",1),a=o.indexOf(".",1),t.push(o.substring(1,~s?s:~a?a:o.length)),f+=!!~s&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(f+=(~s?"?":"")+"\\"+o.substring(a))):f+="/"+o;return{keys:t,pattern:new RegExp("^"+f+(c?"(?=$|/)":"/?$"),"i")}}function m(n,c,p=()=>{}){var s,o,a=[],t={},f=[],h=p;t.req={url:{},params:{}},t.res={run:e=>t.run(e),redirect:(e,r)=>t.route(e,r)};var w=t.format=function(e){return e&&(e="/"+e.replace(/^\/|\/$/g,""),s.test(e)&&e.replace(s,"/"))};return n="/"+(n||"").replace(/^\/|\/$/g,""),s=n=="/"?/^\/+/:new RegExp("^\\"+n+"(?=\\/|$)\\/?","i"),t.route=function(e,r){e[0]=="/"&&!s.test(e)&&(e=n+e),history[(e===o||r?"replace":"push")+"State"](e,null,e)},t.use=function(...e){return f=[...f,...e],t},t.on=function(e,...r){return(e=v(e)).fns=[...f,...r],a.push(e),t},t.run=function(e){var r=0,u={},g,i;if(e=w(e||location.pathname)){for(e=e.match(/[^\?#]*/)[0],o=e;r<a.length;r++)if(g=(i=a[r]).pattern.exec(e)){for(r=0;r<i.keys.length;)u[i.keys[r]]=g[++r]||null;let d=[...i.fns],l=(y,E)=>{try{let x=d.shift();x?x(y,E,k=>k?h(k,y,E):l(y,E)):h(null,y,E)}catch(x){h(x,y,E)}};return t.req.params=u,t.req.url=e,l(t.req,t.res),t}c&&c(e,t.req,t.res)}return t},t.listen=function(e,r){L("push"),L("replace");function u(i){r&&r(),t.run()}function g(i){var d=i.target.closest("a"),l=d&&d.getAttribute("href");i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button||i.defaultPrevented||!l||d.target||d.host!==location.host||l[0]=="#"||(l[0]!="/"||s.test(l))&&(i.preventDefault(),t.route(l))}return addEventListener("popstate",u),addEventListener("replacestate",u),addEventListener("pushstate",u),addEventListener("click",g),t.unlisten=function(){removeEventListener("popstate",u),removeEventListener("replacestate",u),removeEventListener("pushstate",u),removeEventListener("click",g)},t.run(e)},t}function L(n,c){history[n]||(history[n]=n,c=history[n+="State"],history[n]=function(p){var s=new Event(n.toLowerCase());return s.uri=p,c.apply(this,arguments),dispatchEvent(s)})}return m});
