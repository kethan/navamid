(function(v,m){typeof exports=="object"&&typeof module!="undefined"?module.exports=m():typeof define=="function"&&define.amd?define(m):(v=typeof globalThis!="undefined"?globalThis:v||self,v.navamid=m())})(this,function(){"use strict";function v(n,c){if(n instanceof RegExp)return{keys:!1,pattern:n};var p,r,o,a,t=[],f="",h=n.split("/");for(h[0]||h.shift();o=h.shift();)p=o[0],p==="*"?(t.push("wild"),f+="/(.*)"):p===":"?(r=o.indexOf("?",1),a=o.indexOf(".",1),t.push(o.substring(1,~r?r:~a?a:o.length)),f+=!!~r&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(f+=(~r?"?":"")+"\\"+o.substring(a))):f+="/"+o;return{keys:t,pattern:new RegExp("^"+f+(c?"(?=$|/)":"/?$"),"i")}}function m(n,c,p=()=>{}){var r,o,a=[],t={},f=[],h=p;t.req={url:{},params:{}},t.res={run:t.run,redirect:t.route};var w=t.format=function(e){return e&&(e="/"+e.replace(/^\/|\/$/g,""),r.test(e)&&e.replace(r,"/"))};return n="/"+(n||"").replace(/^\/|\/$/g,""),r=n=="/"?/^\/+/:new RegExp("^\\"+n+"(?=\\/|$)\\/?","i"),t.route=function(e,s){e[0]=="/"&&!r.test(e)&&(e=n+e),history[(e===o||s?"replace":"push")+"State"](e,null,e)},t.use=function(...e){return f=[...f,...e],t},t.on=function(e,...s){return(e=v(e)).fns=[...f,...s],a.push(e),t},t.run=function(e){var s=0,u={},g,i;if(e=w(e||location.pathname)){for(e=e.match(/[^\?#]*/)[0],o=e;s<a.length;s++)if(g=(i=a[s]).pattern.exec(e)){for(s=0;s<i.keys.length;)u[i.keys[s]]=g[++s]||null;let d=[...i.fns],l=(y,E)=>{try{let x=d.shift();x?x(y,E,k=>k?h(k,y,E):l(y,E)):h(null,y,E)}catch(x){h(x,y,E)}};return t.req.params=u,t.req.url=e,l(t.req,t.res),t}c&&c(e,t.req,t.res)}return t},t.listen=function(e,s){L("push"),L("replace");function u(i){s&&s(),t.run()}function g(i){var d=i.target.closest("a"),l=d&&d.getAttribute("href");i.ctrlKey||i.metaKey||i.altKey||i.shiftKey||i.button||i.defaultPrevented||!l||d.target||d.host!==location.host||l[0]=="#"||(l[0]!="/"||r.test(l))&&(i.preventDefault(),t.route(l))}return addEventListener("popstate",u),addEventListener("replacestate",u),addEventListener("pushstate",u),addEventListener("click",g),t.unlisten=function(){removeEventListener("popstate",u),removeEventListener("replacestate",u),removeEventListener("pushstate",u),removeEventListener("click",g)},t.run(e)},t}function L(n,c){history[n]||(history[n]=n,c=history[n+="State"],history[n]=function(p){var r=new Event(n.toLowerCase());return r.uri=p,c.apply(this,arguments),dispatchEvent(r)})}return m});
