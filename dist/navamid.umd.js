!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).navamid=t()}(this,(function(){"use strict";function e(e,t){history[e]||(history[e]=e,t=history[e+="State"],history[e]=function(n){var r=new Event(e.toLowerCase());return r.uri=n,t.apply(this,arguments),dispatchEvent(r)})}return function(t,n,r=(()=>{})){var s,i,u=[],o={},a=[],f=r;o.req={url:{},params:{}},o.res={redirect:(e,t)=>o.route(e,t)};var l=o.format=function(e){return e?(e="/"+e.replace(/^\/|\/$/g,""),s.test(e)&&e.replace(s,"/")):e};return t="/"+(t||"").replace(/^\/|\/$/g,""),s="/"==t?/^\/+/:new RegExp("^\\"+t+"(?=\\/|$)\\/?","i"),o.route=function(e,n){"/"!=e[0]||s.test(e)||(e=t+e),history[(e===i||n?"replace":"push")+"State"](e,null,e)},o.use=function(...e){return a=[...a,...e],o},o.on=function(e,...t){return(e=function(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,s,i,u=[],o="",a=e.split("/");for(a[0]||a.shift();s=a.shift();)"*"===(n=s[0])?(u.push("wild"),o+="/(.*)"):":"===n?(r=s.indexOf("?",1),i=s.indexOf(".",1),u.push(s.substring(1,~r?r:~i?i:s.length)),o+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(o+=(~r?"?":"")+"\\"+s.substring(i))):o+="/"+s;return{keys:u,pattern:new RegExp("^"+o+(t?"(?=$|/)":"/?$"),"i")}}(e)).fns=[...a,...t],u.push(e),o},o.run=function(e){var t,r,s=0,a={};if(e=l(e||location.pathname)){for(e=e.match(/[^\?#]*/)[0],i=e;s<u.length;s++)if(t=(r=u[s]).pattern.exec(e)){for(s=0;s<r.keys.length;)a[r.keys[s]]=t[++s]||null;let n=[...r.fns],i=(e,t)=>{try{let r=n.shift();r?r(e,t,(n=>n?f(n,e,t):i(e,t))):f(null,e,t)}catch(r){f(r,e,t)}};return o.req.params=a,o.req.url=e,i(o.req,o.res),o}n&&n(e,o.req,o.res)}return o},o.listen=function(t){function n(e){o.run()}function r(e){var t=e.target.closest("a"),n=t&&t.getAttribute("href");e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button||e.defaultPrevented||n&&!t.target&&t.host===location.host&&"#"!=n[0]&&("/"!=n[0]||s.test(n))&&(e.preventDefault(),o.route(n))}return e("push"),e("replace"),addEventListener("popstate",n),addEventListener("replacestate",n),addEventListener("pushstate",n),addEventListener("click",r),o.unlisten=function(){removeEventListener("popstate",n),removeEventListener("replacestate",n),removeEventListener("pushstate",n),removeEventListener("click",r)},o.run(t)},o}}));
